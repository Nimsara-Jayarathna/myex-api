
# Blipzo API v1.1.0 Release Notes

## Overview
- **Version:** v1.1.0
- **Release Date:** 2026-01-25
- **Summary:** This release significantly expands user management capabilities and introduces multi-currency support. It implements advanced authentication flows including multi-step registration, password resets, and secure email changes. Technologically, v1.1.0 solidifies the move to a service-oriented architecture and introduces dedicated rate limiting for improved security.

## New Features
### Advanced Authentication & User Profile
- **Multi-Step Registration**: Secure registration flow involving initiation, OTP verification, and completion (`/auth/register/*`).
- **Profile Updates**: Endpoint to update basic user details (First Name, Last Name).
- **Password Management**: Full suite of password controls:
  - **Forgot Password**: Request password reset link/OTP.
  - **Reset Password**: Securely reset password using token.
  - **Change Password**: Authenticated password change endpoint.
- **Email Change Flow**: Secure, multi-step process to change user email address, verifying ownership of both old and new email addresses.

### Currency Support
- **Multi-Currency Management**: Users can now select and manage their preferred currency.
- **Currency Endpoints**:
  - `GET /api/v1.1/currencies`: List all supported currencies.
  - `PUT /api/v1.1/users/currency`: Update the authenticated user's preferred currency.

## Improvements / Refactors
### Architectural Changes
- **Service Layer Implementation**: Logic has been moved from controllers to dedicated service files (e.g., `auth.service.js`, `currency.service.js`) in `src/api/v1_1/services/`, promoting better code separation and testability.
- **Route Inheritance**: v1.1 routes fully inherit v1 functionality, ensuring backward compatibility while exposing new features under the `/api/v1.1` namespace.

### Security
- **Rate Limiting**: Integrated `express-rate-limit` via global middleware to protect the API from abuse and brute-force attacks.
- **Standardized Errors (v1.1)**: All `/api/v1.1` errors return a consistent envelope with error codes, while legacy endpoints keep raw success responses for compatibility.
- **Request Hardening**: Added `helmet`, `express-mongo-sanitize`, and `hpp` middleware for safer request handling.
- **Structured Logging**: Added request logging with client/device metadata and hashed user identifiers.

### Documentation
- **API Docs Overhaul**: Expanded and reconciled v1.0.0 and v1.1.0 API docs with full request/response details, validation rules, and error formats.
- **API Overview Summary**: Added a concise cross-version summary document for quick reference.

## Additional Notable Changes
- **Token Hygiene**: Added background cleanup for temporary tokens (registration, reset, email change).
- **Currency Seeding**: Automatic currency seeding on server startup for consistent defaults.
- **Service Refactor (v1)**: Refactored v1 auth/category/transaction logic into service layer for parity with v1.1.
- **Transactions**: Added custom-date endpoint, stricter validation, and timezone-based delete guard.
- **Categories**: Default and limit behavior formalized; returns global + user categories consistently.
- **Responses**: v1.1 uses standardized success envelope for new endpoints while maintaining v1 success payloads for inherited routes.

## API Changes
v1.1 extends v1. All v1 endpoints are available under `/api/v1.1`. New endpoints are exclusive to v1.1:

| Method | Endpoint | Description |
| :--- | :--- | :--- |
| `PUT` | `/api/v1.1/auth/me` | Update user profile details (fname, lname) |
| `POST` | `/api/v1.1/auth/register/init` | Initiate registration (sends OTP) |
| `POST` | `/api/v1.1/auth/register/verify` | Verify registration OTP |
| `POST` | `/api/v1.1/auth/register/complete` | Complete registration & login |
| `POST` | `/api/v1.1/auth/password/forgot` | Request password reset |
| `POST` | `/api/v1.1/auth/password/reset` | Reset password with token |
| `POST` | `/api/v1.1/auth/password/change` | Change current password |
| `POST` | `/api/v1.1/auth/email/change/init` | Initiate email change |
| `POST` | `/api/v1.1/auth/email/change/verify-current` | Verify current email OTP |
| `POST` | `/api/v1.1/auth/email/change/request-new` | Request verification for new email |
| `POST` | `/api/v1.1/auth/email/change/confirm` | Confirm new email change |
| `GET` | `/api/v1.1/currencies` | List available currencies |
| `PUT` | `/api/v1.1/users/currency` | Update user's currency |

## Setup & Migration
No manual database migration is required for existing data, but `npm install` must be run to install new dependencies (`express-rate-limit`, etc.).

### Running the App
Same as v1.0.0:
```bash
npm start
```
